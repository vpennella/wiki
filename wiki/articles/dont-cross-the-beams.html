<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Dont Cross the Beams by Kent Beck</title>
  <meta property="og:title" content="Dont Cross the Beams by Kent Beck" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/dont-cross-the-beams.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/dont-cross-the-beams.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2017-09-08T12:53:01-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

    <link rel="stylesheet" href="/assets/app-03d85529abca8a6b9780ed56673aae09.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><a id="pagetitle" href="/">uqbar-wiki</a></div>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <div class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            <li class="has-dropdown">
                <a href="#">Ayuda</a>
                <ul class="dropdown">
                    <li><a class="link article_link" href="/wiki/articles/FAQ.html">FAQ</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/como-empezar.html">Cómo colaborar</a></li>
                </ul>
            </li>
        </ul>

        <!-- Left Nav Section -->
        <ul class="left">
            <li class="has-dropdown">
                <a href="#">Navegación</a>
                <ul class="dropdown">
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
                </ul>
            </li>
        </ul>
    </div>

</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 10px;">
    <div class="rows" align="center">
        <img src="/img/logoUqbar.jpg" height="70%" width="70%">
    </div>
    <div align="center">
    	<p>
    		<a href="http://www.uqbar-project.org/">Conocenos</a> 
    	</p>
    </div>

    <hr>

    <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
        <li class="button" role="menuitem"><a href="/">Home</a></li>
        <li class="button" role="menuitem"><a href="/articles">Lista de articulos</a></li>
    </ul>

    <hr>

	<ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Materias" role="menu">
            <li class="button" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
    </ul>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Dont Cross the Beams by Kent Beck</i>
    </h1>

    <div id="siteSub">De Uqbar wiki</div>
</div>



<div id="article_content">
    <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">Origen</span></a>
            </li>
            <li class="toc_level-1 toc_section-2">
              <a href="#tocAnchor-1-2"><span class="tocnumber">2</span> <span class="toctext">Articulo</span></a>
              <ul>
                <li class="toc_level-2 toc_section-3">
                  <a href="#tocAnchor-1-2-1"><span class="tocnumber">2.1</span> <span class="toctext">Intro</span></a>
                </li>
                <li class="toc_level-2 toc_section-4">
                  <a href="#tocAnchor-1-2-2"><span class="tocnumber">2.2</span> <span class="toctext">Succession</span></a>
                </li>
                <li class="toc_level-2 toc_section-5">
                  <a href="#tocAnchor-1-2-3"><span class="tocnumber">2.3</span> <span class="toctext">Conclusion</span></a>
                </li>
              </ul>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><h1 id="tocAnchor-1-1">Origen</h1>

<p>Actualmente threeriversinstitute<dot>org no esta activo, tome el articulo de Kent Beck de archives.org en este [link](http://web.archive.org/web/20130113095840/http://www.threeriversinstitute.org/blog/?p=594)</dot></p>

<h1 id="tocAnchor-1-2">Articulo</h1>

<h2 id="tocAnchor-1-2-1">Intro</h2>

<p>As many of my pair programming partners could tell you, I have the annoying habit of saying “Stop thinking” during refactoring. I’ve always known this isn’t exactly what I meant, because I can’t mean it literally, but I’ve never had a better explanation of what I meant until now. So, apologies y’all, here’s what I wished I had said.</p>

<p>One of the challenges of refactoring is succession–how to slice the work of a refactoring into safe steps and how to order those steps. The two factors complicating succession in refactoring are efficiency and uncertainty. Working in safe steps it’s imperative to take those steps as quickly as possible to achieve overall efficiency. At the same time, refactorings are frequently uncertain–”I think I can move this field over there, but I’m not sure”–and going down a dead-end at high speed is not actually efficient.</p>

<p>Inexperienced responsive designers can get in a state where they try to move quickly on refactorings that are unlikely to work out, get burned, then move slowly and cautiously on refactorings that are sure to pay off. Sometimes they will make real progress, but go try a risky refactoring before reaching a stable-but-incomplete state. Thinking of refactorings as horizontal and vertical is a heuristic for turning this situation around–eliminating risk quickly and exploiting proven opportunities efficiently.</p>

<p>The other day I was in the middle of a big refactoring when I recognized the difference between horizontal and vertical refactorings and realized that the code we were working on would make a good example (good examples are by far the hardest part of explaining design). The code in question selected a subset of menu items for inclusion in a user interface. The original code was ten if statements in a row. Some of the conditions were similar, but none were identical. Our first step was to extract 10 Choice objects, each of which had an isValid method and a widget method.</p>

<p>before:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>if (...choice 1 valid...) {
  add($widget1);
}
if (...choice 2 valid...) {
  add($widget2);
}
... 
</code></pre>
</div>

<p>after:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$choices = array(new Choice1(), new Choice2(), ...);
foreach ($choices as $each)
  if ($each-&gt;isValid())
    add($each-&gt;widget());
</code></pre>
</div>

<p>After we had done this, we noticed that the isValid methods had feature envy. Each of them extracted data from an A and a B and used that data to determine whether the choice would be added.</p>

<p>
  <img src="/img/wiki/ChoiceRefactoring.png " title="ChoiceRefactoring.png " alt="" />
</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Choice1 isValid() {
  $data1 = $this-&gt;a-&gt;data1;
  $data2 = $this-&gt;a-&gt;data2;
  $data3 = $this-&gt;a-&gt;b-&gt;data3;
  $data4 = $this-&gt;a-&gt;b-&gt;data4;
  return ...some expression of data1-4...;
}
</code></pre>
</div>

<p>We wanted to move the logic to the data.</p>

<p>
  <img src="/img/wiki/ChoiceRefactoring-1-300x271.png " title="ChoiceRefactoring-1-300x271.png " alt="" />
</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Choice1 isValid() {
  return $this-&gt;a-&gt;isChoice1Valid();
}
A isChoice1Valid() {
  return ...some expression of data1-2 &amp;&amp; $this-b-&gt;isChoice1Valid();
}
</code></pre>
</div>

<h2 id="tocAnchor-1-2-2">Succession</h2>

<p>Which Choice should we work on first? Should we move logic to A first and then B, or B first and then A? How much do we work on one Choice before moving to the next? What about other refactoring opportunities we see as we go along? These are the kinds of succession questions that make refactoring an art.</p>

<p>Since we only suspected that it would be possible to move the isValid methods to A, it didn’t matter much which Choice we started with. The first question to answer was, “Can we move logic to A?” We picked Choice. The refactoring worked, so we had code that looked like:</p>

<p>
  <img src="/img/wiki/ChoiceRefactoring-2-300x271.png " title="ChoiceRefactoring-2-300x271.png " alt="" />
</p>

<div class="highlighter-rouge"><pre class="highlight"><code>A isChoice1Valid() {
  $data3 = $this-&gt;b-&gt;data3;
  $data4 = $this-&gt;b-&gt;data4;
  return ...some expression of data1-4...;
}
</code></pre>
</div>

<p>Again we had a succession decision. Do we move part of the logic along to B or do we go on to the next Choice? I pushed for a change of direction, to go on to the next Choice. I had a couple of reasons:</p>

<ul>
  <li>The code was already clearly cleaner and I wanted to realize that value if possible by refactoring all of the Choices.</li>
  <li>One of the other Choices might still be a problem, and the further we went with our current line of refactoring, the more time we would waste if we hit a dead end and had to backtrack.</li>
</ul>

<p>The first refactoring (move a method to A) is a vertical refactoring. I think of it as moving a method or field up or down the call stack, hence the “vertical” tag. The phase of refactoring where we repeat our success with a bunch of siblings is horizontal, by contrast, because there is no clear ordering between, in our case, the different Choices.</p>

<p>Because we knew that moving the method into A could work, while we were refactoring the other Choices we paid attention to optimization. We tried to come up with creative ways to accomplish the same refactoring safely, but with fewer steps by composing various smaller refactorings in different ways. By putting our heads down and getting through the other nine Choices, we got them done quickly and validated that none of them contained hidden complexities that would invalidate our plan.</p>

<p>Doing the same thing ten times in a row is boring. Half way through my partner started getting good ideas about how to move some of the functionality to B. That’s when I told him to stop thinking. I don’t actually want him to stop thinking, I just wanted him to stay focused on what we were doing. There’s no sense pounding a piton in half way then stopping because you see where you want to pound the next one in.</p>

<p>As it turned out, by the time we were done moving logic to A, we were tired enough that resting was our most productive activity. However, we had code in a consistent state (all the implementations of isValid simply delegated to A) and we knew exactly what we wanted to do next.</p>

<h2 id="tocAnchor-1-2-3">Conclusion</h2>

<p>Not all refactorings require horizontal phases. If you have one big ugly method, you create a Method Object for it, and break the method into tidy shiny pieces, you may be working vertically the whole time. However, when you have multiple callers to refactor or multiple implementors to refactor, it’s time to begin paying attention to going back and forth between vertical and horizontal, keeping the two separate, and staying aware of how deep to push the vertical refactorings.</p>

<p>Keeping an index card next to my computer helps me stay focused. When I see the opportunity for a vertical refactoring in the midst of a horizontal phase (or vice versa) I jot the idea down on the card and get back to what I was doing. This allows me to efficiently finish one job before moving onto the next, while at the same time not losing any good ideas. At its best, this process feels like meditation, where you stay aware of your breath and don’t get caught in the spiral of your own thoughts.</p>

</div>



<div id="article_metadata">
    <p><i>Latest update on July 17, 2017 by
        GitHub</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>1</td>
                                <td>103</td>
                                <td>0</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>1</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>917a5fe</td>
                        <td>Mon Jul 17 23:16:02 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update deploy-en-maven-central.md</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul>

</div>


</div>


<div id="footer">
    <div class="columns small-1 medium-2 large-3">
        <small>(C) 2015-17 Matthias Beyer - Ernesto Bossi</small>
    </div>

    <div class="columns small-11 medium-10 large-9">
    </div>

</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-9954088f87089c387789507249fa70d3.js"></script>
<script src="/assets/jquery.min-650c8b3af3d010ec559014c6e70b13c3.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-8e0f071884576348dba555b27a4bcaa9.js"></script>
<script src="/assets/foundation/foundation.abide-fa5ce9fbf8301ae49154ebc752edc220.js"></script>
<script src="/assets/foundation/foundation.accordion-bcc423fb0c2a3d515ba85ff591171a8e.js"></script>
<script src="/assets/foundation/foundation.alert-609b779b55610f4916250faaa37d1cfc.js"></script>
<script src="/assets/foundation/foundation.clearing-167db0285c7a789f7f216183f9038ac4.js"></script>
<script src="/assets/foundation/foundation.dropdown-25aac997ca0ca5dc3c3094c266c8f5aa.js"></script>
<script src="/assets/foundation/foundation.equalizer-cbdd8079a6f777c37dd1314f9b17faec.js"></script>
<script src="/assets/foundation/foundation.interchange-6ef75863aff8abeff4de79554b62e1b9.js"></script>
<script src="/assets/foundation/foundation.joyride-7cce0075f55d456449419a92671a3874.js"></script>
<script src="/assets/foundation/foundation.magellan-dc0647982e238cf1db3113e50d1b85dd.js"></script>
<script src="/assets/foundation/foundation.offcanvas-61dc0fe57ed932800c4a09b92c1ba4e5.js"></script>
<script src="/assets/foundation/foundation.orbit-9698da4fd068f7b83b3e5c00aae63ab3.js"></script>
<script src="/assets/foundation/foundation.reveal-4944447a204c398659229cfd716786a1.js"></script>
<script src="/assets/foundation/foundation.slider-7ea4b29f663e7e1b52ddc9f7ca0458b3.js"></script>
<script src="/assets/foundation/foundation.tab-c2efa8f5f8b255b06db277c3f339a0c7.js"></script>
<script src="/assets/foundation/foundation.tooltip-4a5d212b8f811ff50bba6cc61a2b899a.js"></script>
<script src="/assets/foundation/foundation.topbar-4dd840d30430ff2146208830574ca615.js"></script>

<script src="/assets/jquery.cookie-61d99d4505fb2f5359bf351153c83f1d.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-2c27791d765f338cd196c9aa9a050936.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-1eea551ba45e704ef55167430bb80ce4.js"></script>
</body>
</html>
