<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Bloques</title>
  <meta property="og:title" content="Bloques" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/bloques.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/bloques.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2017-09-08T12:53:01-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

    <link rel="stylesheet" href="/assets/app-03d85529abca8a6b9780ed56673aae09.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><a id="pagetitle" href="/">uqbar-wiki</a></div>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <div class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            <li class="has-dropdown">
                <a href="#">Ayuda</a>
                <ul class="dropdown">
                    <li><a class="link article_link" href="/wiki/articles/FAQ.html">FAQ</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/como-empezar.html">Cómo colaborar</a></li>
                </ul>
            </li>
        </ul>

        <!-- Left Nav Section -->
        <ul class="left">
            <li class="has-dropdown">
                <a href="#">Navegación</a>
                <ul class="dropdown">
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
                </ul>
            </li>
        </ul>
    </div>

</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 10px;">
    <div class="rows" align="center">
        <img src="/img/logoUqbar.jpg" height="70%" width="70%">
    </div>
    <div align="center">
    	<p>
    		<a href="http://www.uqbar-project.org/">Conocenos</a> 
    	</p>
    </div>

    <hr>

    <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
        <li class="button" role="menuitem"><a href="/">Home</a></li>
        <li class="button" role="menuitem"><a href="/articles">Lista de articulos</a></li>
    </ul>

    <hr>

	<ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Materias" role="menu">
            <li class="button" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
    </ul>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Bloques</i>
    </h1>

    <div id="siteSub">De Uqbar wiki</div>
</div>



<div id="article_content">
    <h2 id="qué-es-un-bloque">¿Qué es un bloque?</h2>

<p>Un bloque (también conocido como closure) es un objeto, y por lo tanto podemos hacer con él lo mismo que hacíamos con los demás objetos esto es:</p>

<ul>
  <li>Enviarle mensajes</li>
  <li>Pasarlo como parámetro de algún mensaje</li>
  <li>Hacer que una variable lo referencie</li>
</ul>

<p>Un objeto bloque representa un cacho de código que no se ejecutó, ese código solo se ejecutará si alguien le manda un mensaje que le indique hacerlo. Veamos algunos ejemplos en el lenguaje Wollok:</p>

<p>Si ejecutamos las siguientes instrucciones:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var x = 0
{ x = x + 1 }
</code></pre>
</div>

<p>¿A qué objeto apunta la variable x después de ejecutar esas 2 líneas de código? ¡Claro, al objeto cero (0)! Porque sólo creamos el bloque, pero el código del mismo nunca se evaluó.</p>

<p>Para que la variable x apunte al objeto uno (1) tenemos que decirle al bloque que se ejecute.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var x = 0
{ x = x + 1 }.apply()
</code></pre>
</div>

<p>Ahora sí, después de ejecutar esas 2 líneas de código la variable x va a apuntar al objeto uno (1). Es importante darse cuenta que apply() es un mensaje que le llega al objeto bloque. Este mensaje hace que se ejecute el código que está dentro del bloque y que se retorne el objeto devuelto por la última sentencia del bloque.</p>

<h2 id="conocimiento-del-contexto">Conocimiento del contexto</h2>

<p>Algo que se pone en evidencia en este ejemplo introductorio es que los bloques tienen una noción del contexto en el cual fueron definidos, y por eso es que tienen acceso a las referencias disponibles en dicho contexto. Es por eso que es posible usar la variable x que había sido definida fuera del bloque.</p>

<p>Si tuviéramos el siguiente código:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>object pepita {
  var energia = 100
  
  method volar(metros) {
    energia -= 10 - metros
  }
  
  method irYVolverNVeces(metros, veces){
    veces.times({ self.volar(metros * 2) })
  }
}
</code></pre>
</div>

<p>Y luego evaluamos: <code class="highlighter-rouge">pepita.irYVolverNVeces(5, 3)</code></p>

<p>El mensaje <code class="highlighter-rouge">times(algoParaHacer)</code> que se le manda al número 3 con el bloque que construímos en ese momento se encargará de mandarle el mensaje <code class="highlighter-rouge">apply()</code> al bloque que le pasamos, en este caso, 3 veces. Dado que la referencia metros existía en el contexto en el cual ese bloque fue creado (era un parámetro del método), es válido usar esa referencia dentro de la lógica del bloque y va a apuntar al objeto 5, como es de esperarse.</p>

<p>Otra pregunta interesante es: <strong>¿quién es <a href="self---pseudovariable.html">self</a> dentro del bloque?</strong></p>

<p>Cuando usamos self dentro de un bloque, estamos referenciando al mismo objeto que recibió el mensaje dentro del cual se creó el bloque, lo cual es muy convieniente ya que hace que no necesitemos parametrizar a self si necesitamos mandarle mensajes o parametrizarlo a otro mensaje dentro del código del bloque.</p>

<p>Entonces el resultado de la operación será que la energía de pepita se habrá decrementado en 60.</p>

<h2 id="bloques-como-funciones">Bloques como funciones</h2>

<p>También se puede ver a los bloques como objetos que representan una función sin nombre (o sea, una función anónima, como las <a href="expresiones-lambda.html">Expresiones lambda</a> de funcional!).</p>

<p>El bloque <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">1</span><span class="w"> </span><span class="p">}</span></code> en Wollok es como una función constante que siempre devuelve 1 si le decís que se ejecute. Pero el chiste de las funciones es que reciban parámetros y los bloques también pueden recibir parámetros, por ejemplo la sintaxis de Wollok para un bloque de dos parámetros es <code class="highlighter-rouge"><span class="p">{</span><span class="err"> parametro1, parametro2 =&gt; cuerpoDelBloque </span><span class="p">}</span></code></p>

<p>Ejemplos:</p>

<p>Podríamos representar las siguientes funciones…</p>

<p><code class="highlighter-rouge">f(x) = 2x</code></p>

<p><code class="highlighter-rouge">g(x,y) = x2 + y2</code></p>

<p>… con bloques de la siguiente forma:</p>

<p><code class="highlighter-rouge">var f = {x =&gt; 2 * x }</code></p>

<p><code class="highlighter-rouge">var g = {x, y =&gt; x ** 2 + y ** 2 }</code></p>

<p>¿Cómo hacemos para usar bloques que tienen parámetros? Por ejemplo si quisiéramos los equivalentes a evaluar las funciones f(4) y g(4,3)</p>

<p><code class="highlighter-rouge">f.apply(4) // Esto devuelve el objeto 8</code></p>

<p><code class="highlighter-rouge">g.apply(4, 3) // Esto devuelve el objeto 25</code></p>

<p>Por lo general el uso que le damos a los bloques es sólo la creación de los mismos para pasar por parámetro a funcionalidad ya existente de propósito general, como son los mensajes de colecciones <a href="mensajes-de-colecciones.html">Mensajes de colecciones</a>, y no tanto la aplicación de los mismos. Sin embargo es interesante saber cómo es que las colecciones son capaces de evaluar lo que les pedimos.</p>

<p>Para pensar: ¿Los mensajes que esperan por parámetro un bloque, podrán recibir por parámetro un objeto programado por nosotros? ¿Qué es lo que una colección necesita realmente que le pasemos por parámetro para poder realizar un filtrado?</p>

<h2 id="cómo-funciona-el-iftrue-y-el-iffalse-de-smalltalk">¿Cómo funciona el #ifTrue: y el #ifFalse: de <strong>Smalltalk</strong>?</h2>

<p>En el caso de Smalltalk, el uso de bloques es aún más generalizado, ya que al no existir estructuras de control y tener una sintaxis completamente basada en mensajes a objetos, los bloques se usan por ejemplo para poder saber qué hacer en un condicional cuando la condición se cumple o no se cumple. Esto se logra mediante ditintos mensajes que entienden los booleanos que representan la condición sobre la cual queremos decidir.</p>

<p>Si en un workspace escribimos</p>

<p><code class="highlighter-rouge">pepita energia &gt; 0 ifTrue: [ pepita come: 30 ]</code></p>

<p>Pensando en términos de objeto y mensaje (mensaje = selector + parámetros) qué está pasando acá???</p>

<p>El objeto receptor del mensaje <code class="highlighter-rouge">ifTrue:</code> es el objeto que me devuelve <code class="highlighter-rouge">pepita energia &gt; 0</code>, ese objeto puede ser true o false.</p>

<p>Si el receptor es true queremos que el bloque <code class="highlighter-rouge">[ pepita come: 30 ]</code> se ejecute. Si el receptor es false NO queremos que el bloque <code class="highlighter-rouge">[ pepita come: 30 ]</code> se ejecute.</p>

<p>Entonces el objeto que tiene la responsabilidad de saber si el bloque debe o no ejecutarse es el booleano receptor del mensaje <code class="highlighter-rouge">ifTrue:</code>.</p>

<p>Siendo false la única instancia de la clase False y true la única instancia de la clase True, la implementación del método <code class="highlighter-rouge">ifTrue:</code> en cada una de las clases es</p>

<div class="highlighter-rouge"><pre class="highlight"><code>True &gt;&gt; ifTrue: unBloque
  "self apunta a true entonces queremos que se ejecute el bloque"
  ^unBloque value 
  
False &gt;&gt; ifTrue: unBloque
  "self apunta a false entonces NO queremos que se ejecute el bloque"
  ^nil
</code></pre>
</div>

<p>O sea que las estructuras de control a las que estábamos acostumbrados por el paradigma estructurado, no son más que mensajes polimórficos :D Todo sigue las mismas reglas, objetos y mensajes</p>

</div>



<div id="article_metadata">
    <p><i>Latest update on September 08, 2017 by
        GitHub</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>3</td>
                                <td>175</td>
                                <td>49</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>1</td>
                            </tr>
                            
                            <tr>
                                <td>Mariana</td>
                                <td>mmatos8...</td>
                                <td>2</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>7014ec9</td>
                        <td>Fri Sep 8 12:48:12 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Agrego ejemplo para hablar de contextos y self</td>
                    </tr>
                    
                    <tr>
                        <td>7912f4d</td>
                        <td>Thu Sep 7 20:29:22 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update bloques.md</td>
                    </tr>
                    
                    <tr>
                        <td>917a5fe</td>
                        <td>Mon Jul 17 23:16:02 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update deploy-en-maven-central.md</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul>

</div>


</div>


<div id="footer">
    <div class="columns small-1 medium-2 large-3">
        <small>(C) 2015-17 Matthias Beyer - Ernesto Bossi</small>
    </div>

    <div class="columns small-11 medium-10 large-9">
    </div>

</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-9954088f87089c387789507249fa70d3.js"></script>
<script src="/assets/jquery.min-650c8b3af3d010ec559014c6e70b13c3.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-8e0f071884576348dba555b27a4bcaa9.js"></script>
<script src="/assets/foundation/foundation.abide-fa5ce9fbf8301ae49154ebc752edc220.js"></script>
<script src="/assets/foundation/foundation.accordion-bcc423fb0c2a3d515ba85ff591171a8e.js"></script>
<script src="/assets/foundation/foundation.alert-609b779b55610f4916250faaa37d1cfc.js"></script>
<script src="/assets/foundation/foundation.clearing-167db0285c7a789f7f216183f9038ac4.js"></script>
<script src="/assets/foundation/foundation.dropdown-25aac997ca0ca5dc3c3094c266c8f5aa.js"></script>
<script src="/assets/foundation/foundation.equalizer-cbdd8079a6f777c37dd1314f9b17faec.js"></script>
<script src="/assets/foundation/foundation.interchange-6ef75863aff8abeff4de79554b62e1b9.js"></script>
<script src="/assets/foundation/foundation.joyride-7cce0075f55d456449419a92671a3874.js"></script>
<script src="/assets/foundation/foundation.magellan-dc0647982e238cf1db3113e50d1b85dd.js"></script>
<script src="/assets/foundation/foundation.offcanvas-61dc0fe57ed932800c4a09b92c1ba4e5.js"></script>
<script src="/assets/foundation/foundation.orbit-9698da4fd068f7b83b3e5c00aae63ab3.js"></script>
<script src="/assets/foundation/foundation.reveal-4944447a204c398659229cfd716786a1.js"></script>
<script src="/assets/foundation/foundation.slider-7ea4b29f663e7e1b52ddc9f7ca0458b3.js"></script>
<script src="/assets/foundation/foundation.tab-c2efa8f5f8b255b06db277c3f339a0c7.js"></script>
<script src="/assets/foundation/foundation.tooltip-4a5d212b8f811ff50bba6cc61a2b899a.js"></script>
<script src="/assets/foundation/foundation.topbar-4dd840d30430ff2146208830574ca615.js"></script>

<script src="/assets/jquery.cookie-61d99d4505fb2f5359bf351153c83f1d.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-2c27791d765f338cd196c9aa9a050936.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-1eea551ba45e704ef55167430bb80ce4.js"></script>
</body>
</html>
