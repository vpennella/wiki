<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Reflection</title>
  <meta property="og:title" content="Reflection" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/reflection.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/reflection.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2017-09-08T12:53:01-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

    <link rel="stylesheet" href="/assets/app-03d85529abca8a6b9780ed56673aae09.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><a id="pagetitle" href="/">uqbar-wiki</a></div>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <div class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            <li class="has-dropdown">
                <a href="#">Ayuda</a>
                <ul class="dropdown">
                    <li><a class="link article_link" href="/wiki/articles/FAQ.html">FAQ</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/como-empezar.html">Cómo colaborar</a></li>
                </ul>
            </li>
        </ul>

        <!-- Left Nav Section -->
        <ul class="left">
            <li class="has-dropdown">
                <a href="#">Navegación</a>
                <ul class="dropdown">
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
                </ul>
            </li>
        </ul>
    </div>

</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 10px;">
    <div class="rows" align="center">
        <img src="/img/logoUqbar.jpg" height="70%" width="70%">
    </div>
    <div align="center">
    	<p>
    		<a href="http://www.uqbar-project.org/">Conocenos</a> 
    	</p>
    </div>

    <hr>

    <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
        <li class="button" role="menuitem"><a href="/">Home</a></li>
        <li class="button" role="menuitem"><a href="/articles">Lista de articulos</a></li>
    </ul>

    <hr>

	<ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Materias" role="menu">
            <li class="button" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
    </ul>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Reflection</i>
    </h1>

    <div id="siteSub">De Uqbar wiki</div>
</div>



<div id="article_content">
    <p>Es un caso particular de <a href="metaprogramacion.html">metaprogramación</a>, donde “metaprogramamos” en el mismo lenguaje en que están escritos (o vamos a escribir) los programas. Es decir, todo desde el mismo lenguaje.</p>

<p>Nota de color: Inicialmente el lenguaje “pionero” en cuanto a reflection fue LISP.</p>

<p>El ejemplo más visible de esto es el caso de smalltalk, donde no existe una diferenciación entre IDE y nuestro programa. Ambos estan hechos en smalltalk, y de hecho viven en un mismo ambiente. Ambos estan construidos con objetos y pueden interactuar entre sí.</p>

<p>De hecho, muchos componentes del “IDE” Pharo son elementos de metaprogramación, y utilizan reflection para inspeccionar nuestras clases y objetos.</p>

<h2 id="tipos-de-reflection">Tipos de reflection</h2>

<p>Para esto, generalmente, es necesario contar con facilidades o herramientas específicas, digamos “soporte” del lenguaje. Entonces reflection, además, abarca los siguientes items que vamos a mencionar en esta lista:</p>

<ul>
  <li>Introspection: se refiere a la capacidad de un sistema, de analizarse a sí mismo. Algo así como la introspección humana, pero en términos de programa. Para eso, el lenguaje debe proveer ciertas herramientas, que le permitan al mismo programa, “ver” o “reflejar” cada uno de sus componentes.</li>
  <li>Self-Modification: es la capacidad de un programa de modificarse a sí mismo. Nuevamente esto requiere cierto soporte del lenguaje. Y las limitaciones van a depender de este soporte.</li>
  <li>Intercession: es la capacidad de modificar la semántica del modelo que estamos manipulando, desde el mismo lenguaje.</li>
</ul>

<p>Un MOP (MetaObject Protocol) es un framework de objetos que describe o modela un sistema de objetos. MOP sería el término correcto para lo que en java llamamos API de reflection. En realidad el API de reflection de java es un caso de MOP.</p>

<p>Dependiendo de la implementación y del lenguaje, el MOP puede soportar o no los tipos de reflection que enumeramos arriba: introspection, self-modification &amp; intercession.</p>

<h2 id="introspection">Introspection</h2>

<p>Se refiere a poder obtener información acerca de los elementos de nuestro programa: clases, fields, métodos, funciones, predicados (en otros paradigmas).</p>

<p>La capacidad de introspection es la más común en los MOP’s. Digamos que es la más “simple” de implementar, comparándolas con los otros tipos de reflection.</p>

<p>Veamos algunas herramientas que nos dan los lenguajes Java y Smalltalk (Pharo):</p>

<p><strong>Información estática:</strong></p>

<p><code class="highlighter-rouge">Para obtener la clase de un objeto:</code>
<code class="highlighter-rouge">   en Java: getClass</code>
<code class="highlighter-rouge">   en Pharo: class</code>
<code class="highlighter-rouge">   </code>
<code class="highlighter-rouge">En la clase class están los métodos:</code>
<code class="highlighter-rouge">   en Java: getMethods, getDeclaredMethods, getFields, getConstructors, getMethod, getSuperclass</code>
<code class="highlighter-rouge">   en Pharo: instVariables, methodDictionary, superclass</code></p>

<p><strong>Información dinámica:</strong></p>

<p><code class="highlighter-rouge">Obtener el valor de un field:</code>
<code class="highlighter-rouge">   en Java: unField.get(unObjeto)</code>
<code class="highlighter-rouge">   en Pharo: unObjeto instVarNamed: fieldName</code>
<code class="highlighter-rouge">Setear el valor de un field:</code>
<code class="highlighter-rouge">   en Java: unField.set(unObjeto, unValor)</code>
<code class="highlighter-rouge">   en Pharo: unObjeto instVarNamed: fieldName put: unValor</code>
<code class="highlighter-rouge">Invocar un método:</code>
<code class="highlighter-rouge">   en Java: unMethod.invoke(unObjeto, parametro1, parametro2, ...)</code>
<code class="highlighter-rouge">   en Pharo: unObjeto perform: #selector withArguments: listaDeParametros</code>
<code class="highlighter-rouge">Crear una instancia:</code>
<code class="highlighter-rouge">   en Java: unConstructor.invoke(parametro1, parametro2, ...) o unaClase.newInstance()</code>
<code class="highlighter-rouge">   en Pharo: unaClase new    </code></p>

<h2 id="self-modification">Self-modification</h2>

<p>Supongamos que queremos hacer el refactor <strong>extract superclass</strong>, para esto vamos a usar self-modification en Pharo, donde modificar el metamodelo usando el mismo lenguaje es algo cotidiano por ejemplo, para crear una clase usamos el template que nos provee el System Browser:</p>

<p><code class="highlighter-rouge"> Object subclass: #NameOfSubclass</code>
<code class="highlighter-rouge">   instanceVariableNames: ''</code>
<code class="highlighter-rouge">   classVariableNames: ''</code>
<code class="highlighter-rouge">   poolDictionaries: ''</code>
<code class="highlighter-rouge">   category: ''.</code></p>

<p>que no es más que un mensaje que se le manda a la clase Object.</p>

<p>Lo que hacemos es, dada una clase, crear una super clase a partir de ella, diciéndole el nombre de le nueva clase, las variables de instancia que quiero que tenga, los métodos que quiero que tenga. Así es como nos gustaría poder usarlo:</p>

<p><code class="highlighter-rouge">SimpleExtractSuperclassRefactoring </code>
<code class="highlighter-rouge">  extractSuperclass: #Guerrero</code>
<code class="highlighter-rouge">  withInstanceVariables: Soldado instVarNames</code>
<code class="highlighter-rouge">  andMethods: (Soldado selectors difference: #(paso fuerza))</code>
<code class="highlighter-rouge">  fromClass: Soldado.</code></p>

<p>El resultado de esta prueba debería ser crear una clase Guerrero, a partir de otra clase Soldado ya existente. Guerrero va a ser superclase de Soldado y va a tener todas las variables de instancia que tiene Soldado (le podríamos especificar cuáles variables de instancia queremos ponerle, pero por simplicidad, le pasamos todas). También vamos a mover todos los métodos de Soldado, excepto paso y fuerza.</p>

<p>Por supuesto, nuestro refactor debe ser independiente del dominio de los guerreros. Nuestro metaprograma sería básicamente (obviando accessors):</p>

<p><code class="highlighter-rouge">#SimpleExtractSuperclassRefactoring class</code>
<code class="highlighter-rouge">&gt;&gt; extractSuperclass: newSuperClassName withInstanceVariables: instanceVariableNames andMethods: selectorsToMove fromClass: aClass</code>
<code class="highlighter-rouge"> self new</code>
<code class="highlighter-rouge">   target: aClass;</code>
<code class="highlighter-rouge">   superClassName: newSuperClassName;</code>
<code class="highlighter-rouge">   instanceVariableNames: instanceVariableNames;</code>
<code class="highlighter-rouge">   selectors: selectorsToMove; </code>
<code class="highlighter-rouge">   execute.</code></p>

<p><code class="highlighter-rouge">#SimpleExtractSuperclassRefactoring</code>
<code class="highlighter-rouge">&gt;&gt; execute</code>
<code class="highlighter-rouge">  self createSuperClass.</code>
<code class="highlighter-rouge">  self moveInstanceVariables.</code>
<code class="highlighter-rouge">  self moveMethods.</code></p>

<p><code class="highlighter-rouge">&gt;&gt; createSuperClass</code>
<code class="highlighter-rouge">  self targetSuperClass: (self target superclass</code>
<code class="highlighter-rouge">                                     subclass: self superClassName</code>
<code class="highlighter-rouge">                                     instanceVariableNames: ''</code>
<code class="highlighter-rouge">                                     classVariableNames: ''</code>
<code class="highlighter-rouge">                                     poolDictionaries: ''</code>
<code class="highlighter-rouge">                                     category: self target category).</code>
<code class="highlighter-rouge">  self targetSuperClass subclass: self target name</code>
<code class="highlighter-rouge">                        instanceVariableNames: self target instanceVariablesString</code>
<code class="highlighter-rouge">                        classVariableNames: self target classVariablesString</code>
<code class="highlighter-rouge">                        poolDictionaries: '' "Ahora no nos importa, pero habría que copiarlo también para que no se pierda"</code>
<code class="highlighter-rouge">                        category: self target category.</code></p>

<p><code class="highlighter-rouge">&gt;&gt; moveInstanceVariables</code>
<code class="highlighter-rouge">  self instanceVariableNames do: [:instVarName |</code>
<code class="highlighter-rouge">    self target removeInstVarNamed: instVarName.</code>
<code class="highlighter-rouge">    self targetSuperClass addInstVarNamed: instVarName. ]</code></p>

<p><code class="highlighter-rouge">&gt;&gt; moveMethods</code>
<code class="highlighter-rouge">  self selectors do: [:selector |</code>
<code class="highlighter-rouge">    self targetSuperClass compile: (self target &gt;&gt; selector) getSource.</code>
<code class="highlighter-rouge">    self target removeSelector: selector. ]</code>
<code class="highlighter-rouge"> </code></p>

<p>Algunos métodos de self-modification que usamos:</p>

<ul>
  <li><strong>Agregar un método:</strong> unaClase compile: ‘…código del método’</li>
  <li><strong>Borrar un método:</strong> unaClase removeSelector: #selector</li>
  <li><strong>Agregar una variable de instancia:</strong> unaClase addInstVarNamed: ‘nombre de la variable’</li>
  <li><strong>y para borrarla:</strong> unaClase removeInstVarNamed: ‘nombre de la variable’</li>
</ul>


</div>



<div id="article_metadata">
    <p><i>Latest update on July 17, 2017 by
        GitHub</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>1</td>
                                <td>131</td>
                                <td>0</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>1</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>917a5fe</td>
                        <td>Mon Jul 17 23:16:02 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update deploy-en-maven-central.md</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul>

</div>


</div>


<div id="footer">
    <div class="columns small-1 medium-2 large-3">
        <small>(C) 2015-17 Matthias Beyer - Ernesto Bossi</small>
    </div>

    <div class="columns small-11 medium-10 large-9">
    </div>

</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-9954088f87089c387789507249fa70d3.js"></script>
<script src="/assets/jquery.min-650c8b3af3d010ec559014c6e70b13c3.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-8e0f071884576348dba555b27a4bcaa9.js"></script>
<script src="/assets/foundation/foundation.abide-fa5ce9fbf8301ae49154ebc752edc220.js"></script>
<script src="/assets/foundation/foundation.accordion-bcc423fb0c2a3d515ba85ff591171a8e.js"></script>
<script src="/assets/foundation/foundation.alert-609b779b55610f4916250faaa37d1cfc.js"></script>
<script src="/assets/foundation/foundation.clearing-167db0285c7a789f7f216183f9038ac4.js"></script>
<script src="/assets/foundation/foundation.dropdown-25aac997ca0ca5dc3c3094c266c8f5aa.js"></script>
<script src="/assets/foundation/foundation.equalizer-cbdd8079a6f777c37dd1314f9b17faec.js"></script>
<script src="/assets/foundation/foundation.interchange-6ef75863aff8abeff4de79554b62e1b9.js"></script>
<script src="/assets/foundation/foundation.joyride-7cce0075f55d456449419a92671a3874.js"></script>
<script src="/assets/foundation/foundation.magellan-dc0647982e238cf1db3113e50d1b85dd.js"></script>
<script src="/assets/foundation/foundation.offcanvas-61dc0fe57ed932800c4a09b92c1ba4e5.js"></script>
<script src="/assets/foundation/foundation.orbit-9698da4fd068f7b83b3e5c00aae63ab3.js"></script>
<script src="/assets/foundation/foundation.reveal-4944447a204c398659229cfd716786a1.js"></script>
<script src="/assets/foundation/foundation.slider-7ea4b29f663e7e1b52ddc9f7ca0458b3.js"></script>
<script src="/assets/foundation/foundation.tab-c2efa8f5f8b255b06db277c3f339a0c7.js"></script>
<script src="/assets/foundation/foundation.tooltip-4a5d212b8f811ff50bba6cc61a2b899a.js"></script>
<script src="/assets/foundation/foundation.topbar-4dd840d30430ff2146208830574ca615.js"></script>

<script src="/assets/jquery.cookie-61d99d4505fb2f5359bf351153c83f1d.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-2c27791d765f338cd196c9aa9a050936.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-1eea551ba45e704ef55167430bb80ce4.js"></script>
</body>
</html>
