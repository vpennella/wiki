<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Problemas comunes con los tipos numericos de haskell</title>
  <meta property="og:title" content="Problemas comunes con los tipos numericos de haskell" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/problemas-comunes-con-los-tipos-numericos-de-haskell.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/problemas-comunes-con-los-tipos-numericos-de-haskell.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2017-09-08T12:53:01-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

    <link rel="stylesheet" href="/assets/app-03d85529abca8a6b9780ed56673aae09.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><a id="pagetitle" href="/">uqbar-wiki</a></div>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <div class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            <li class="has-dropdown">
                <a href="#">Ayuda</a>
                <ul class="dropdown">
                    <li><a class="link article_link" href="/wiki/articles/FAQ.html">FAQ</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/como-empezar.html">Cómo colaborar</a></li>
                </ul>
            </li>
        </ul>

        <!-- Left Nav Section -->
        <ul class="left">
            <li class="has-dropdown">
                <a href="#">Navegación</a>
                <ul class="dropdown">
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
                </ul>
            </li>
        </ul>
    </div>

</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 10px;">
    <div class="rows" align="center">
        <img src="/img/logoUqbar.jpg" height="70%" width="70%">
    </div>
    <div align="center">
    	<p>
    		<a href="http://www.uqbar-project.org/">Conocenos</a> 
    	</p>
    </div>

    <hr>

    <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
        <li class="button" role="menuitem"><a href="/">Home</a></li>
        <li class="button" role="menuitem"><a href="/articles">Lista de articulos</a></li>
    </ul>

    <hr>

	<ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Materias" role="menu">
            <li class="button" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
    </ul>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Problemas comunes con los tipos numericos de haskell</i>
    </h1>

    <div id="siteSub">De Uqbar wiki</div>
</div>



<div id="article_content">
    <h2 id="para-salir-del-paso">Para salir del paso…</h2>

<p>Al programar en <code class="highlighter-rouge">Haskell</code> suele pasar que <em>muy</em> frecuentemente tenemos problemas con los tipos numéricos, en particular suele ocurrir al intentar hacer divisiones. Por ejemplo en el siguiente programa, la función <code class="highlighter-rouge">division</code></p>

<p><code class="highlighter-rouge">division xs = sum xs / length xs</code></p>

<p>Produce el siguiente error:</p>

<p><code class="highlighter-rouge">ERROR - Unresolved overloading</code>
<code class="highlighter-rouge">*** Type       : Fractional Int =&gt; [Int] -&gt; Int</code>
<code class="highlighter-rouge">*** Expression : \xs -&gt; sum xs / lgth xs</code></p>

<p>El problema surge porque el <code class="highlighter-rouge">Haskell</code> tiene diferentes tipos de valores numéricos (enteros, reales, etc) un sistema de tipos muy estricto que hace que no sea sencillo mezclar los distintos tipos de valores en una misma operación.</p>

<p>La versión corta es que <code class="highlighter-rouge">length</code> <code class="highlighter-rouge">xs</code> es un entero y la operación <code class="highlighter-rouge">/</code> no está definida para los números enteros. Por lo tanto es necesario convertir el resultado de <code class="highlighter-rouge">length</code> <code class="highlighter-rouge">xs</code> al tipo de datos adecuado, utilizando la función <code class="highlighter-rouge">fromIntegral</code>:</p>

<p><code class="highlighter-rouge">division xs = sum xs / length xs</code></p>

<p>Esto funciona siempre que yo quiera hacer una división no-entera y uno de los parámetros (o ambos) es un entero. Para hacer divisiones enteras tenemos las funciones <code class="highlighter-rouge">div</code> y <code class="highlighter-rouge">mod</code>.</p>

<p><code class="highlighter-rouge">division xs = sum xs / fromIntegral (length xs)</code></p>

<p>Ó bien:</p>

<p><code class="highlighter-rouge">division xs = fromIntegral (sum xs) / fromIntegral (length xs)</code></p>

<h2 id="la-historia-completa">La historia completa</h2>

<h3 id="la-división-no-está-definida-para-los-enteros">¿La división no está definida para los enteros?</h3>

<p>Para comprender la totalidad del problema, es necesario comprender el tipo de la función <code class="highlighter-rouge">(/)</code>:</p>

<p><code class="highlighter-rouge">Main&gt; :t (/)</code>
<code class="highlighter-rouge">(/) :: Fractional a =&gt; a -&gt; a -&gt; a</code></p>

<p>Se puede ver que <code class="highlighter-rouge">(/)</code> es una función polimórfica, es decir que puede ser utilizada con diferentes tipos de datos. Sin embargo no puede ser utilizada con <em>cualquier</em> tipo de dato; la restricción es que el tipo tiene que ser <em>instancia</em> de la clase <code class="highlighter-rouge">Fractional</code>. En particular, los tipos enteros de Haskell (<code class="highlighter-rouge">Int</code> e <code class="highlighter-rouge">Integer</code>) no son instancias de <code class="highlighter-rouge">Fractional</code>, por lo tanto siempre que se tenga un valor de alguno de esos tipos deberá ser <em>convertido</em> utilizando la función <code class="highlighter-rouge">fromIntegral</code>.</p>

<p>Con esa idea en mente, analizamos los tipos de las funciones del ejemplo de la sección anterior:</p>

<p><code class="highlighter-rouge">Main&gt; :t sum</code>
<code class="highlighter-rouge">sum :: Num a =&gt; [a] -&gt; a</code>
<code class="highlighter-rouge">Main&gt; :t length</code>
<code class="highlighter-rouge">length :: [b] -&gt; Int</code></p>

<p>Y podemos concluir que sum no tendrá problemas, porque funciona para cualquier tipo numérico (por definición todas las instancias de <code class="highlighter-rouge">Fractional</code> son instancias de <code class="highlighter-rouge">Num</code>.</p>

<p>En cambio la función <code class="highlighter-rouge">length</code> no es polimórfica en cuanto a su valor de retorno; aunque puede recibir cualquier tipo de lista, siempre devuelve un <code class="highlighter-rouge">Int</code>. Entonces el resultado de <code class="highlighter-rouge">length</code> no puede ser parámetro de <code class="highlighter-rouge">(/)</code>.</p>

<h3 id="algunos-casos-más-complicados">Algunos casos más complicados</h3>

<p>Supongamos que no utilizamos la función <code class="highlighter-rouge">sum</code>, y en cambio queremos definir la nuestra propia, de la siguiente manera:</p>

<p><code class="highlighter-rouge">suma = foldr (+) 0</code></p>

<p>O bien (para no definir una que ya existe), podemos definir</p>

<p><code class="highlighter-rouge">prod = foldr (*) 1</code></p>

<p>¿Funcionan las siguientes definiciones?</p>

<p><code class="highlighter-rouge">div2  xs = suma xs / fromIntegral (length xs)</code>
<code class="highlighter-rouge">floca xs = prod xs / fromIntegral (length xs)</code></p>

<p>Si intentamos hacer eso, obtendremos el siguiente error:</p>

<p><code class="highlighter-rouge">ERROR </code><a href="file:.\pruebas.hs:15"><code class="highlighter-rouge">file:.\pruebas.hs:15</code></a><code class="highlighter-rouge"> - Instance of Fractional Integer required for definition of div2</code></p>

<p>Para entender por qué se produce esto, debemos analizar nuevamente los tipos de <code class="highlighter-rouge">suma</code> y <code class="highlighter-rouge">prod</code>:</p>

<p><code class="highlighter-rouge">Hugs&gt; :t suma</code>
<code class="highlighter-rouge">suma :: [Integer] -&gt; Integer</code>
<code class="highlighter-rouge">Main&gt; :t prod</code>
<code class="highlighter-rouge">prod :: [Integer] -&gt; Integer</code></p>

<p>Y como se puede ver devuelven valores de tipo <code class="highlighter-rouge">Integer</code> que, como dijimos antes, no es instancia de <code class="highlighter-rouge">Fractional</code> y por lo tanto no funciona.</p>

<p>La idea de la sección anterior también puede servir en este caso (aunque no es la única forma):</p>

<p><code class="highlighter-rouge">div2  xs = fromIntegral (suma xs) / fromIntegral (length xs)</code>
<code class="highlighter-rouge">floca xs = fromIntegral (prod xs) / fromIntegral (length xs)</code></p>

<h3 id="aprovechando-mejor-el-polimorfismo">Aprovechando mejor el polimorfismo</h3>

<p>En realidad hay una forma mejor de solucionar el problema planteado en la sección. La desventaja de la solución descripta consiste en que, al resolverlo de esa manera, la función suma sólo funciona para valores de tipo <code class="highlighter-rouge">Integer</code>; lo que puede resultar muy restrictivo en un futuro.</p>

<p>¿Por qué sucede esto? Como sabemos, el <code class="highlighter-rouge">Haskell</code> trabaja con <a href="inferencia-de-tipos.html">inferencia de tipos</a>, por lo tanto, cuando nosotros no indicamos en nuestro programa de qué tipo son los valores que espera y devuelve una función, el sistema intentará descubrir ese tipo por nosotros. Normalmente este mecanismo de inferencia es suficiente y resulta de gran utilidad, ya que nos permite tener un lenguaje fuertemente tipado que nos ayuda a encontrar muchos errores en nuestro código en una fase previa a la ejecución del programa, al mismo tiempo que nos evita de la burocracia y el engorro de tener que indicar el tipo de cada función explícitamente.</p>

<p>Sin embargo en este caso el tipo inferido por el sistema de tipos de <code class="highlighter-rouge">Haskell</code> es <em>subóptimo</em>. El tipo inferido es <code class="highlighter-rouge">[Integer]</code> <code class="highlighter-rouge">-&gt;</code> <code class="highlighter-rouge">Integer</code>, es decir, que sólo funciona para listas de tipo <code class="highlighter-rouge">Integer</code>.</p>

<p>Sin embargo, si miramos la definición de <code class="highlighter-rouge">suma</code>, podemos ver que se basa en las funciones <code class="highlighter-rouge">foldr</code> y <code class="highlighter-rouge">(+)</code>, cuyos tipos son:</p>

<p><code class="highlighter-rouge">Main&gt; :t foldr</code>
<code class="highlighter-rouge">foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>
<code class="highlighter-rouge">Main&gt; :t (+)</code>
<code class="highlighter-rouge">(+) :: Num a =&gt; a -&gt; a -&gt; a</code></p>

<p>Es decir que no hay ningún motivo para restringir el tipo a <code class="highlighter-rouge">[Integer]</code> <code class="highlighter-rouge">-&gt;</code> <code class="highlighter-rouge">Integer</code>, dado que <code class="highlighter-rouge">foldr</code> funciona para cualquier tipo de lista y <code class="highlighter-rouge">(+)</code> funciona para todos los tipos de la familia <code class="highlighter-rouge">Num</code> (es decir, todos los tipos numéricos predefinidos del Haskell). De hecho, si consultamos el tipo de la expresión <code class="highlighter-rouge">foldr</code> <code class="highlighter-rouge">(+)</code> <code class="highlighter-rouge">0</code>, obtenemos:</p>

<p><code class="highlighter-rouge">Main&gt; :t foldr (+) 0</code>
<code class="highlighter-rouge">foldr (+) 0 :: Num a =&gt; [a] -&gt; a</code></p>

<p>Que es el tipo que buscamos.</p>

<p>Lamentablemente, cuando intenta inferir un tipo automáticament para la función <code class="highlighter-rouge">suma</code>, el <code class="highlighter-rouge">Haskell</code> le asigna un tipo <em>monomórfico</em>, defaulteando en el tipo <code class="highlighter-rouge">Integer</code>. La forma de evitar esta restricción es haciendo explícita nuestra intención de que la función suma sea <em>polmórfica</em>, esto se logra asociando a la función una indicación del tipo esperado.</p>

<p>El tipo esperado no es otro que el de la expresión <code class="highlighter-rouge">foldr</code> <code class="highlighter-rouge">(+)</code> <code class="highlighter-rouge">0</code>, es decir, <code class="highlighter-rouge">Num</code> <code class="highlighter-rouge">a</code> <code class="highlighter-rouge">=&gt;</code> <code class="highlighter-rouge">[a]</code> <code class="highlighter-rouge">-&gt;</code> <code class="highlighter-rouge">a</code>. La definición de la función quedaría así:</p>

<p><code class="highlighter-rouge">suma :: Num a =&gt; [a] -&gt; a</code>
<code class="highlighter-rouge">suma = foldr (+) 0</code></p>

<p>Al hacer ese cambio la siguiente definición pasa a estar correctamente tipada:</p>

<p><code class="highlighter-rouge">div2  xs = suma xs / fromIntegral (length xs)</code></p>

</div>



<div id="article_metadata">
    <p><i>Latest update on July 17, 2017 by
        GitHub</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>1</td>
                                <td>120</td>
                                <td>0</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>1</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>917a5fe</td>
                        <td>Mon Jul 17 23:16:02 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update deploy-en-maven-central.md</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul>

</div>


</div>


<div id="footer">
    <div class="columns small-1 medium-2 large-3">
        <small>(C) 2015-17 Matthias Beyer - Ernesto Bossi</small>
    </div>

    <div class="columns small-11 medium-10 large-9">
    </div>

</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-9954088f87089c387789507249fa70d3.js"></script>
<script src="/assets/jquery.min-650c8b3af3d010ec559014c6e70b13c3.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-8e0f071884576348dba555b27a4bcaa9.js"></script>
<script src="/assets/foundation/foundation.abide-fa5ce9fbf8301ae49154ebc752edc220.js"></script>
<script src="/assets/foundation/foundation.accordion-bcc423fb0c2a3d515ba85ff591171a8e.js"></script>
<script src="/assets/foundation/foundation.alert-609b779b55610f4916250faaa37d1cfc.js"></script>
<script src="/assets/foundation/foundation.clearing-167db0285c7a789f7f216183f9038ac4.js"></script>
<script src="/assets/foundation/foundation.dropdown-25aac997ca0ca5dc3c3094c266c8f5aa.js"></script>
<script src="/assets/foundation/foundation.equalizer-cbdd8079a6f777c37dd1314f9b17faec.js"></script>
<script src="/assets/foundation/foundation.interchange-6ef75863aff8abeff4de79554b62e1b9.js"></script>
<script src="/assets/foundation/foundation.joyride-7cce0075f55d456449419a92671a3874.js"></script>
<script src="/assets/foundation/foundation.magellan-dc0647982e238cf1db3113e50d1b85dd.js"></script>
<script src="/assets/foundation/foundation.offcanvas-61dc0fe57ed932800c4a09b92c1ba4e5.js"></script>
<script src="/assets/foundation/foundation.orbit-9698da4fd068f7b83b3e5c00aae63ab3.js"></script>
<script src="/assets/foundation/foundation.reveal-4944447a204c398659229cfd716786a1.js"></script>
<script src="/assets/foundation/foundation.slider-7ea4b29f663e7e1b52ddc9f7ca0458b3.js"></script>
<script src="/assets/foundation/foundation.tab-c2efa8f5f8b255b06db277c3f339a0c7.js"></script>
<script src="/assets/foundation/foundation.tooltip-4a5d212b8f811ff50bba6cc61a2b899a.js"></script>
<script src="/assets/foundation/foundation.topbar-4dd840d30430ff2146208830574ca615.js"></script>

<script src="/assets/jquery.cookie-61d99d4505fb2f5359bf351153c83f1d.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-2c27791d765f338cd196c9aa9a050936.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-1eea551ba45e704ef55167430bb80ce4.js"></script>
</body>
</html>
