<!DOCTYPE html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    


  <title>Como hacer predicados de orden superior</title>
  <meta property="og:title" content="Como hacer predicados de orden superior" />






<link rel="canonical" href="wiki.uqbar.org/wiki/articles/como-hacer-predicados-de-orden-superior.html" />
<meta property="og:url" content="wiki.uqbar.org/wiki/articles/como-hacer-predicados-de-orden-superior.html" />
<meta property="og:site_name" content="uqbar-wiki" />
<meta name="application-name" content="uqbar-wiki"/>

<meta property="og:updated_time" content=" 2017-09-08T12:53:01-03:00" />






  <meta property="keywords" content="" />











    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" >
    <link type="text/plain" rel="author" href="/humans.txt"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

    <link rel="stylesheet" href="/assets/app-03d85529abca8a6b9780ed56673aae09.css">
    <style>
        .navbar {
            -webkit-backface-visibility: hidden;
        }
    </style>
</head>

<body>

<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <li class="name">
            <div id="pagetitle"><a id="pagetitle" href="/">uqbar-wiki</a></div>
        </li>
        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <div class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
            <li class="has-dropdown">
                <a href="#">Ayuda</a>
                <ul class="dropdown">
                    <li><a class="link article_link" href="/wiki/articles/FAQ.html">FAQ</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/como-empezar.html">Cómo colaborar</a></li>
                </ul>
            </li>
        </ul>

        <!-- Left Nav Section -->
        <ul class="left">
            <li class="has-dropdown">
                <a href="#">Navegación</a>
                <ul class="dropdown">
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
                    <li class="link article_link" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
                </ul>
            </li>
        </ul>
    </div>

</nav>

<div class="column small-0 medium-2 large-2 sidebar" style="margin-top: 10px;">
    <div class="rows" align="center">
        <img src="/img/logoUqbar.jpg" height="70%" width="70%">
    </div>
    <div align="center">
    	<p>
    		<a href="http://www.uqbar-project.org/">Conocenos</a> 
    	</p>
    </div>

    <hr>

    <ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Links" role="menu">
        <li class="button" role="menuitem"><a href="/">Home</a></li>
        <li class="button" role="menuitem"><a href="/articles">Lista de articulos</a></li>
    </ul>

    <hr>

	<ul class="rows small-12 medium-10 large-10 side-nav stack button-group" title="Materias" role="menu">
            <li class="button" role="menuitem"><a href="/wiki/articles/paradigmas-de-programacion.html">Paradigmas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/design-temario.html">Diseño - Algoritmos II</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/tecnicas-avanzadas-de-programacion.html">Técnicas avanzadas de programación</a></li>
        <li class="button" role="menuitem"><a href="/wiki/articles/algo3-temario.html">Algoritmos III</a></li>
    </ul>
</div>

<div class="column small-12 medium-10 large-10">
    <div id="article_title">
    <h1>
        <i>Como hacer predicados de orden superior</i>
    </h1>

    <div id="siteSub">De Uqbar wiki</div>
</div>



<div id="article_content">
    <p>Recordemos los predicados de orden superior que vimos hasta el momento, esos “predicados que relacionan predicados”:</p>

<ul>
  <li>not/1</li>
  <li>findall/3</li>
  <li>forall/2</li>
</ul>

<p>¿Eso es todo lo que hay? No, por supuesto que no. Existen muchos otros predicados de orden superior “pre-construidos” (built-in), pero esta base nos alcanza para lo que queremos ver en la materia. Pero lo más interesante es que podemos construir nuestros propios predicados de orden superior, sin embargo vamos a ver que no es tan natural como sí era en Haskell.</p>

<h2 id="call--1">call / 1</h2>

<p>El predicado call/1 nos permite evaluar un predicado pasado por parámetro. Retomando uno de nuestros primeros ejemplos, veamos cómo se usaría:</p>

<p><code class="highlighter-rouge">?- call(padre(Padre, Hijo)).</code>
<code class="highlighter-rouge">Padre = homero</code>
<code class="highlighter-rouge">Hijo = bart ;</code>
<code class="highlighter-rouge">...</code></p>

<p>Pero eso no aporta mucho respecto de hacerlo en forma directa:</p>

<p><code class="highlighter-rouge">?- padre(Padre, Hijo).</code>
<code class="highlighter-rouge">Padre = homero</code>
<code class="highlighter-rouge">Hijo = bart ;</code>
<code class="highlighter-rouge">...</code></p>

<p>Se supone que sólo tiene sentido usar esto si no sabemos qué consulta es la que nos van a pasar por parámetro y usamos el call/1 para definir algo más genérico. Veamos otra variante, entonces, que puede resultarnos más interesante y útil para lo que sí podemos llegar a usar.</p>

<h2 id="call--_">call / _</h2>

<p>El predicado call/_ también nos permite evaluar un predicado pasado por parámetro, pero separando los parámetros que el mismo recibe:</p>

<p><code class="highlighter-rouge">?- call(padre, Padre, Hijo).</code>
<code class="highlighter-rouge">Padre = homero</code>
<code class="highlighter-rouge">Hijo = bart ;</code>
<code class="highlighter-rouge">...</code></p>

<p>O también:</p>

<p><code class="highlighter-rouge">?- call(padre(homero), Hijo).</code>
<code class="highlighter-rouge">Hijo = bart ;</code>
<code class="highlighter-rouge">...</code></p>

<p>Momento, momento… entonces, ¿cuál es la aridad de call/_? El predicado call/_ no tiene definida una aridad fija. Puede tener desde 1 (la versión que vimos antes) hasta N + 1, siendo N la aridad del predicado que se recibe como primer parámetro.</p>

<p>Usando este predicado podemos hacer cosas equivalentes (¡no iguales!) a las que hacíamos con orden superior en Haskell. Juguemos un poco con esto: implementemos map y filter.</p>

<h2 id="creando-nuestros-propios-predicados-de-orden-superior">Creando nuestros propios predicados de orden superior</h2>

<h3 id="el-viejo-y-querido-filter">el viejo y querido filter</h3>

<p>La cuestión de los parámetros es igual a la anterior: vamos a necesitar uno más que lo que tenía filter en Haskell para unificar la lista resultante. Hagamos también dos versiones.</p>

<p><strong>Versión recursiva:</strong></p>

<p><code class="highlighter-rouge">filterRecursivo( _ , [] , [] ).</code>
<code class="highlighter-rouge">filterRecursivo(Pred, [X | Xs], [X | Ys]):-</code>
<code class="highlighter-rouge">  call(Pred, X),</code>
<code class="highlighter-rouge">  filterRecursivo(Pred, Xs, Ys).</code>
<code class="highlighter-rouge">filterRecursivo(Pred, [X | Xs], Ys):-</code>
<code class="highlighter-rouge">  not(call(Pred, X)),</code>
<code class="highlighter-rouge">  filterRecursivo(Pred, Xs, Ys).</code></p>

<p><strong>Versión no recursiva:</strong></p>

<p><code class="highlighter-rouge">filterNoRecursivo(Pred, ListaOrigen, ListaResultante):-</code>
<code class="highlighter-rouge">  findall(X, (member(X, ListaOrigen), call(Pred, X)), ListaResultante).</code></p>

<p>Ejemplos de consulta:</p>

<p><code class="highlighter-rouge">?- filterRecursivo(padre(homero), [herbert, lisa, maggie, homero, bart], ListaFiltrada).</code>
<code class="highlighter-rouge">ListaFiltrada = [lisa, maggie, bart] ;</code>
<code class="highlighter-rouge">No</code>
<code class="highlighter-rouge">?- filterNoRecursivo(padre(homero), [herbert, lisa, maggie, homero, bart], ListaFiltrada).</code>
<code class="highlighter-rouge">ListaFiltrada = [lisa, maggie, bart] ;</code>
<code class="highlighter-rouge">No</code></p>

<p>Buenísimo :D Este predicado también existe como built-in y, como el título lo dice, es <strong>include/3</strong>.</p>

<h3 id="el-viejo-y-querido-map">el viejo y querido map</h3>

<p>Empecemos por lo básico… ¿cuántos parámetros tenía la función map?</p>

<p><code class="highlighter-rouge">&gt; map f lista</code></p>

<p>Tenía dos parámetros, una función de transformación “f” y una lista, y la función era aplicable a cada elemento de la lista.</p>

<p>Entonces, ¿cuántos argumentos va a tener nuestra relación maplist? Vamos a tener el predicado de transformación y la lista, por supuesto. Pero también necesitamos un argumento más para unificarlo con la lista resultante del mapeo. Tenemos también que considerar las cosas que relaciona el predicado: un elemento de la lista original con uno de la lista resultante.</p>

<p><code class="highlighter-rouge">?- map(Predicado, ListaOriginal, ListaResultante).</code></p>

<p>Ejemplo de uso:</p>

<p><code class="highlighter-rouge">?- map(padre, [homero,abe], Hijos).</code>
<code class="highlighter-rouge">Hijos = [[bart,lisa,maggie],[homero,herbert]]</code></p>

<p>Ok, pensemos cómo lo podríamos implementar para que haga lo que queremos?</p>

<p><strong>Versión 1 con recursividad</strong></p>

<p><code class="highlighter-rouge">mapRecursivo( _ , [] , [] ).</code>
<code class="highlighter-rouge">mapRecursivo(Pred, [X|Xs], [Y|Ys]):-</code>
<code class="highlighter-rouge">  call(Pred, X, Y),</code>
<code class="highlighter-rouge">  mapRecursivo(Pred, Xs, Ys).</code></p>

<p>Ejemplos de consulta:</p>

<p><code class="highlighter-rouge">?- mapRecursivo(padre, [homero,abe], Hijos).</code>
<code class="highlighter-rouge">Hijos= [bart, homero] ;</code>
<code class="highlighter-rouge">Hijos= [bart, herbert] ;</code>
<code class="highlighter-rouge">Hijos= [lisa, homero] ;</code>
<code class="highlighter-rouge">Hijos= [lisa, herbert] ;</code>
<code class="highlighter-rouge">Hijos= [maggie, homero] ;</code>
<code class="highlighter-rouge">Hijos= [maggie, herbert] ;</code>
<code class="highlighter-rouge">No</code></p>

<p>Ok… esto no hace lo que queremos, vemos que vamos a tener múltiples respuestas donde para cada padre me mappea con un único hijo de ese padre. Pensándolo desde un punto de vista genérico, más allá del dominio particular, nuestra primer implementación nos da N respuestas con todas las combinaciones posibles de mapeo, pero siempre con mapeos 1 a 1 para cada elemento de la lista original. Qué más se nos ocurre?</p>

<p><strong>Versión 2 con findall</strong> También podríamos hacer una versión no recursiva:</p>

<p><code class="highlighter-rouge">mapNoRecursivo(Pred, ListaOriginal, ListaResultante):-</code>
<code class="highlighter-rouge">   findall(Y, (member(X, ListaOriginal), call(Pred, X, Y)), ListaResultante).</code></p>

<p>Ejemplos de consulta:</p>

<p><code class="highlighter-rouge">?- mapNoRecursivo(padre, [homero,abe], Hijos).</code>
<code class="highlighter-rouge">Hijos = [bart, lisa, maggie, homero, herbert] ;</code>
<code class="highlighter-rouge">No</code></p>

<p>Para nuestra implementación no recursiva la respuesta es única, pero están en la misma lista los hijos de todos y según nuestro ejemplo de uso esperado que dijimos al principio queríamos que nos de una lista de listas, sino no podemos distinguir los que son hijos de homero respecto a los de abe.</p>

<p>Las dos implementaciones que realizamos sin embargo funcionarían correctamente con relaciones que cumplan con unicidad (con lo cual estaríamos más cerca del mundo funcional, no siempre queremos esto, depende del problema). Si modeláramos la relación hijosDe/2 como:</p>

<p><code class="highlighter-rouge">hijosDe(Padre,Hijos):- findall(Hijo, padre(Padre,Hijo), Hijos).</code></p>

<p>Podríamos hacer la siguiente consulta</p>

<p><code class="highlighter-rouge">?- mapNoRecursivo(hijosDe, [homero,abe], Hijos).</code>
<code class="highlighter-rouge">Hijos = [[bart,lisa,maggie],[homero,herbert]]</code></p>

<p>Y el resultado sería idéntico al de nuestro mapRecursivo.</p>

<p><strong>Y cuál es el que está bien?</strong> La respuesta es depende. Si buscamos múltiples respuestas con relaciones 1 a 1 vamos a querer la primera, si buscamos una única respuesta que englobe todas las respuestas posibles vamos a querer la segunda, y si queremos que sea 1 a 1 con una única respuesta tenemos que asegurarnos de que nuestro dominio esté modelado de forma acorde, incluso podríamos tener una tercer versión como esta:</p>

<p><strong>Versión 3 con recursividad y findall</strong></p>

<p><code class="highlighter-rouge">mapListaDeListas( _ , [] , [] ).</code>
<code class="highlighter-rouge">mapListaDeListas(Pred, [X|Xs], [Y|Ys]):-</code>
<code class="highlighter-rouge">  findall(Z,call(Pred, X, Z),Y),</code>
<code class="highlighter-rouge">  mapListaDeListas(Pred, Xs, Ys).</code></p>

<p>Esta consulta va a hacer lo que queríamos originalmente, pero siempre nos va a dar una lista de listas y capaz no queremos eso…</p>

<p><code class="highlighter-rouge">?- mapListaDeListas(padre, [homero,abe], Hijos).</code>
<code class="highlighter-rouge">Hijos = [[bart,lisa,maggie],[homero,herbert]]</code></p>

<p>Ya que estamos en lógico, pensemos qué otras consultas podríamos querer hacer:</p>

<p><code class="highlighter-rouge">?- mapRecursivo(padre, Padres, [bart, lisa, maggie]).</code>
<code class="highlighter-rouge">Padres = [homero, homero, homero] ;</code>
<code class="highlighter-rouge">No</code></p>

<p>Nuestra primer versión recursiva es inversible para el segundo o el tercer argumento (aunque no ambos simultáneamente). Si probamos lo mismo con nuestra versión no recursiva, nos vamos a encontrar con un problema ya que en la implementación estamos usando member/2 con la primera lista, y member/2 no es inversible para la lista.</p>

<p>Lógicamente ninguna versión será inversible respecto al primer argumento, ya que necesita saber qué predicado quiere consultar en el call.</p>

<p>Bueno, la versión built-in de map en SWI-Prolog es <strong>maplist/3</strong>, y se comporta como nuestra versión recursiva.</p>

<h3 id="cómo-seguimos">¿Cómo seguimos?</h3>

<p>Otro predicado de orden superior muy útil es mejorSegun/3 que relaciona un predicado de aridad 2 a invocar, una lista y al valor que maximiza el segundo argumento del predicado en cuestión. Se animan a resolverlo?</p>

</div>



<div id="article_metadata">
    <p><i>Latest update on July 17, 2017 by
        GitHub</i></p>

    <ul class="accordion" data-accordion>
        <li class="accordion-navigation">
            <a href="#panel1a">Page History, Meta information</a>

            <div id="panel1a" class="content">

                <div class="rows">
                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Page Commits</th>
                                <th>Page Additions</th>
                                <th>Page Deletions</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr>
                                <td>1</td>
                                <td>177</td>
                                <td>0</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="column small-12 medium-6 large-6">
                        <table>
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Commits</th>
                            <tr>
                            </thead>

                            <tbody>
                            
                            <tr>
                                <td>Fernando Dodino</td>
                                <td>fernand...</td>
                                <td>1</td>
                            </tr>
                            
                            </tbody>
                        </table>
                    </div>
                </div>

                <table style="margin-left: 15px;">
                    <thead>
                    <tr>
                        <th>Hash</th>
                        <th>Time</th>
                        <th>Name</th>
                        <th>Mail</th>
                        <th>Subject</th>
                    <tr>
                    </thead>

                    <tbody>
                    
                    <tr>
                        <td>917a5fe</td>
                        <td>Mon Jul 17 23:16:02 2017 -0300</td>
                        <td>GitHub</td>
                        <td>noreply...</td>
                        <td>Update deploy-en-maven-central.md</td>
                    </tr>
                    
                    </tbody>
                </table>

            </div>
        </li>
    </ul>

</div>


</div>


<div id="footer">
    <div class="columns small-1 medium-2 large-3">
        <small>(C) 2015-17 Matthias Beyer - Ernesto Bossi</small>
    </div>

    <div class="columns small-11 medium-10 large-9">
    </div>

</div>

<script>
    'use strict';
</script>

<script src="/assets/jquery-9954088f87089c387789507249fa70d3.js"></script>
<script src="/assets/jquery.min-650c8b3af3d010ec559014c6e70b13c3.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js" type="text/javascript"></script>

<script src="/assets/foundation/foundation-8e0f071884576348dba555b27a4bcaa9.js"></script>
<script src="/assets/foundation/foundation.abide-fa5ce9fbf8301ae49154ebc752edc220.js"></script>
<script src="/assets/foundation/foundation.accordion-bcc423fb0c2a3d515ba85ff591171a8e.js"></script>
<script src="/assets/foundation/foundation.alert-609b779b55610f4916250faaa37d1cfc.js"></script>
<script src="/assets/foundation/foundation.clearing-167db0285c7a789f7f216183f9038ac4.js"></script>
<script src="/assets/foundation/foundation.dropdown-25aac997ca0ca5dc3c3094c266c8f5aa.js"></script>
<script src="/assets/foundation/foundation.equalizer-cbdd8079a6f777c37dd1314f9b17faec.js"></script>
<script src="/assets/foundation/foundation.interchange-6ef75863aff8abeff4de79554b62e1b9.js"></script>
<script src="/assets/foundation/foundation.joyride-7cce0075f55d456449419a92671a3874.js"></script>
<script src="/assets/foundation/foundation.magellan-dc0647982e238cf1db3113e50d1b85dd.js"></script>
<script src="/assets/foundation/foundation.offcanvas-61dc0fe57ed932800c4a09b92c1ba4e5.js"></script>
<script src="/assets/foundation/foundation.orbit-9698da4fd068f7b83b3e5c00aae63ab3.js"></script>
<script src="/assets/foundation/foundation.reveal-4944447a204c398659229cfd716786a1.js"></script>
<script src="/assets/foundation/foundation.slider-7ea4b29f663e7e1b52ddc9f7ca0458b3.js"></script>
<script src="/assets/foundation/foundation.tab-c2efa8f5f8b255b06db277c3f339a0c7.js"></script>
<script src="/assets/foundation/foundation.tooltip-4a5d212b8f811ff50bba6cc61a2b899a.js"></script>
<script src="/assets/foundation/foundation.topbar-4dd840d30430ff2146208830574ca615.js"></script>

<script src="/assets/jquery.cookie-61d99d4505fb2f5359bf351153c83f1d.js"></script>
<!-- Script pointing to jekyll-search.js -->
<script src="/assets/jekyll-search-2c27791d765f338cd196c9aa9a050936.js"></script>

<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        json: "/search.json"
    });

    $(document).foundation();

</script>

<!-- prism.js -->
<script src="/assets/prism-1eea551ba45e704ef55167430bb80ce4.js"></script>
</body>
</html>
